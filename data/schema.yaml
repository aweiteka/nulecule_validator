$schema: http://json-schema.org/draft-04/schema#
title: Nulecule
description: Nulecule app definition spec
type: object
properties:
    id:
        description: The machine readable id of the Container Application
        type: string

    specversion:
        description: The semantic version string of the Container Application Specification used to describe the app
        anyOf:
          - type: string
          - type: number

    # METADATA
    metadata:
        description: An object holding optional metadata related to the Container Application
        type: object
        required: [ name, appversion, description, license ]
        properties:
            appversion:
                description: The semantic version string of the Container Application.
                anyOf:
                  - type: string
                  - type: number
            description:
                description: A human readable description of the Container Application. This may contain information for the deployer of the containerapp.
                type: string
            license:
                type: object
                properties:
                    name:
                        description: The human readable license name used for the Container Application, no format imposed.
                        type: string
                    url:
                        description: A URL to the license used for the API. MUST be in the format of a URL.
                        type: string
                        pattern: '^[a-zA-Z]+://.*$'
                required: [ name, url ]
            name:
                description: A human readable name of the containerapp
                type: string

    # GRAPH
    graph:
        description: A list of depending containerapps.
        type: object
        additionalProperties:
            type: object
            properties:
                params:
                    type: object
                    additionalProperties:
                        type: object
                        required: [ description ]
                        properties:
                            description:
                                type: string
                            constraints:
                                type: object
                                required: [ allowed_pattern, description ]
                                properties:
                                    allowed_pattern:
                                        type: string
                                    description:
                                        type: string
                            default:
                                type: string
                artifacts:
                    type: object
                    additionalProperties:
                        type: array
                        items:
                            oneOf:
                              - type: string
                              - type: object
                                properties:
                                    inherit:
                                        type: array
                                        items:
                                            type: string
                source:
                    type: string
                    pattern: '^[a-zA-Z]+://.*$'

    # REQUIREMENTS
    requirements:
        type: array
required: [ id, specversion ]
